<div class="customer-care-css">
    <div class="dispatcher-hero-image">
         <app-hero-image [title]="title"></app-hero-image>
     </div>

     <div class="example-container dispatcher mat-elevation-z8">

        <mat-table [dataSource]="dataSource" matSort>
      
            <ng-container matColumnDef="date">
                <mat-header-cell *matHeaderCellDef mat-sort-header> Date </mat-header-cell>
                <mat-cell *matCellDef="let row" data-label="date"> {{row.rideDate}} </mat-cell>
            </ng-container>

          <ng-container matColumnDef="username">
            <mat-header-cell *matHeaderCellDef mat-sort-header> User Name </mat-header-cell>
            <mat-cell *matCellDef="let row" data-label="username"> {{row.userObject.name}} </mat-cell>
          </ng-container>
      
          <!-- Last Name Column -->
          <ng-container matColumnDef="useremail">
            <mat-header-cell *matHeaderCellDef mat-sort-header> User Email </mat-header-cell>
            <mat-cell *matCellDef="let row" data-label="useremail"> {{row.userObject.email}} </mat-cell>
          </ng-container>
      
    
            <!-- emailid Column -->
            <ng-container matColumnDef="userphn">
            <mat-header-cell *matHeaderCellDef mat-sort-header> User Phone Number </mat-header-cell>
            <mat-cell *matCellDef="let row" data-label="userphn"> {{row.userObject.phNum}} </mat-cell>
            </ng-container>
    
            <!-- phonenumber Column -->
            <ng-container matColumnDef="fromAddress">
                <mat-header-cell *matHeaderCellDef mat-sort-header> From Address </mat-header-cell>
                <mat-cell *matCellDef="let row" data-label="fromAddress"> {{row.from_Address}} </mat-cell>
            </ng-container>        
    
            <!-- phonenumber Column -->
            <ng-container matColumnDef="toAddress">
                <mat-header-cell *matHeaderCellDef mat-sort-header> To Address </mat-header-cell>
                <mat-cell *matCellDef="let row" data-label="toAddress"> {{row.to_Address}} </mat-cell>
            </ng-container>         
    
            <!-- phonenumber Column -->
            <ng-container matColumnDef="usercomment">
                <mat-header-cell *matHeaderCellDef mat-sort-header> User Comment </mat-header-cell>
                <mat-cell *matCellDef="let row" data-label="usercomment"> {{row.message}} </mat-cell>
            </ng-container>                 
    
            <!-- phonenumber Column -->
            <ng-container matColumnDef="driver">
                <mat-header-cell *matHeaderCellDef mat-sort-header> Driver </mat-header-cell>
                <mat-cell *matCellDef="let row" data-label="driver"> 
                    <button mat-raised-button color="primary" (click)="openDriverDailog(drivertemplate,row.driverId)">Open Driver</button>
                
                </mat-cell>
            </ng-container>

            <!-- phonenumber Column -->
            <ng-container matColumnDef="car">
                <mat-header-cell *matHeaderCellDef mat-sort-header> Car </mat-header-cell>
                <mat-cell *matCellDef="let row" data-label="car"> 
                    <button mat-raised-button color="primary" (click)="openCar(row.carId,cartemplate)">Open Car</button>
                </mat-cell>
            </ng-container>
            
            <ng-container matColumnDef="addcomment">
                <mat-header-cell *matHeaderCellDef mat-sort-header> Add Executive Commen </mat-header-cell>
                <mat-cell *matCellDef="let row" data-label="addcomment"> 
                    <button mat-raised-button color="primary" (click)="openCommentDailog(executiveComment,row.ride_id,row.userObject.user_id,row.message)">Add Comment</button>
                </mat-cell>
            </ng-container>
            
    
          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns;">
          </mat-row>
        </mat-table>
      
        <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
      </div>
      
</div> 

<ng-template #drivertemplate>
    <h1 mat-dialog-title>Driver Details </h1>
<div mat-dialog-content>
</div>
</ng-template>


<ng-template #cartemplate>
    <h1 mat-dialog-title>Car Details </h1>
<div mat-dialog-content>

    <div class="row">
        <div class="col-md-6 font-bold">
            Model
        </div>

        <div class="col-md-6">
            {{selectedCarInfo.carModel}}
        </div>

        <div class="col-md-6 font-bold">
            Color
        </div>

        <div class="col-md-6">
            {{selectedCarInfo.carColor}}
        </div>

        <div class="col-md-6 font-bold">
            Registration Id
        </div>
        <div class="col-md-6">
            {{selectedCarInfo.carRegisterId}}
        </div>

        <div class="col-md-6 font-bold">
            Comfort Level
        </div>
        <div class="col-md-6">
            {{selectedCarInfo.comfortLevel}}
        </div>

        <div class="col-md-6 font-bold">
            Dispatcher Name
        </div>
        <div class="col-md-6">
            {{selectedCarInfo.dispatcher.firstName}} {{selectedCarInfo.dispatcher.lastName}}
        </div>

        <div class="col-md-6 font-bold">
            Dispatcher EmailId
        </div>
        <div class="col-md-6">
            {{selectedCarInfo.dispatcher.email}} 
        </div>

        <div class="col-md-6 font-bold">
            Dispatcher RegId
        </div>
        <div class="col-md-6">
            {{selectedCarInfo.dispatcher.disRegId}} 
        </div>

        
    </div>
    <button mat-raised-button mat-dialog-close>Close</button>

</div>
</ng-template>


<ng-template #executiveComment>
    <h1 mat-dialog-title>Add Comment </h1>
<div mat-dialog-content>

    <div class="row">
        <div *ngFor="let comments of selectedCommentList">
            <div class="comment-date">
                Date:
            </div>
            <div class="comment-reason" [innerHtml]="comments.reason">
                {{comments.reason}}
            </div>
        </div>
    </div>

    <form [formGroup]="executiveFormGroup">
              <mat-form-field >
                  <mat-label>Add Comment</mat-label>
                  <textarea matInput maxlength="1000" formControlName="comment"
                            cdkTextareaAutosize
                            #autosize="cdkTextareaAutosize"
                            cdkAutosizeMinRows="1"
                            cdkAutosizeMaxRows="5"></textarea>

                  <mat-hint align="end">{{executiveFormGroup.controls['comment'].value.length}} / 1000</mat-hint>
                </mat-form-field>
    </form>

</div>
<div mat-dialog-actions class="delete-dailog-actions">
    <div class="no-css">
        <button mat-raised-button mat-dialog-close>Cancel</button>
    </div>
    <div class="yes-css">
        <button mat-raised-button class="confirm-css"  color="primary" (click)="submitComment()">Submit To Admin</button>
        <button mat-raised-button class="confirm-css"  color="accent" (click)="addComment()">Add Comment</button>
    </div>
  </div>
</ng-template>

